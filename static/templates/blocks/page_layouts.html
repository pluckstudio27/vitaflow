<!-- Layouts de Página Personalizáveis -->

<!-- Layout: Página de Listagem com Filtros -->
{% macro list_page_layout(title, subtitle='', show_add_button=true, add_button_text='Adicionar', add_button_url='#', filters=[], search_placeholder='Buscar...') %}
<div class="container-fluid">
    <!-- Cabeçalho da Página -->
    <div class="row mb-4">
        <div class="col-md-8">
            <h1 class="h3 mb-0">{{ title }}</h1>
            {% if subtitle %}
            <p class="text-muted">{{ subtitle }}</p>
            {% endif %}
        </div>
        {% if show_add_button and (is_super_admin or is_admin_central or is_gerente_almox) %}
        <div class="col-md-4 text-end">
            <a href="{{ add_button_url }}" class="btn btn-primary">
                <i class="fas fa-plus me-1"></i>{{ add_button_text }}
            </a>
        </div>
        {% endif %}
    </div>

    <!-- Filtros e Busca -->
    {% if filters or search_placeholder %}
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="row g-3">
                        {% if search_placeholder %}
                        <div class="col-md-4">
                            <input type="text" class="form-control" placeholder="{{ search_placeholder }}" id="search-input">
                        </div>
                        {% endif %}
                        {% for filter in filters %}
                        <div class="col-md-3">
                            <select class="form-select" id="filter-{{ filter.name }}">
                                <option value="">{{ filter.label }}</option>
                                {% for option in filter.options %}
                                <option value="{{ option.value }}">{{ option.text }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        {% endfor %}
                        <div class="col-md-2">
                            <button type="button" class="btn btn-outline-secondary w-100" onclick="clearFilters()">
                                <i class="fas fa-times me-1"></i>Limpar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Conteúdo Principal -->
    <div class="row">
        <div class="col-12">
            {% block page_content %}{% endblock %}
        </div>
    </div>
</div>
{% endmacro %}

<!-- Layout: Página de Formulário -->
{% macro form_page_layout(title, subtitle='', form_id='main-form', back_url='#', back_text='Voltar') %}
<div class="container-fluid">
    <!-- Cabeçalho da Página -->
    <div class="row mb-4">
        <div class="col-md-8">
            <h1 class="h3 mb-0">{{ title }}</h1>
            {% if subtitle %}
            <p class="text-muted">{{ subtitle }}</p>
            {% endif %}
        </div>
        <div class="col-md-4 text-end">
            <a href="{{ back_url }}" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left me-1"></i>{{ back_text }}
            </a>
        </div>
    </div>

    <!-- Formulário -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <form id="{{ form_id }}">
                        {% block form_content %}{% endblock %}
                        
                        <div class="row mt-4">
                            <div class="col-12">
                                <hr>
                                <div class="d-flex justify-content-end gap-2">
                                    <a href="{{ back_url }}" class="btn btn-secondary">
                                        <i class="fas fa-times me-1"></i>Cancelar
                                    </a>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-1"></i>Salvar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endmacro %}

<!-- Layout: Página de Detalhes -->
{% macro detail_page_layout(title, subtitle='', show_edit_button=true, edit_button_url='#', back_url='#') %}
<div class="container-fluid">
    <!-- Cabeçalho da Página -->
    <div class="row mb-4">
        <div class="col-md-6">
            <h1 class="h3 mb-0">{{ title }}</h1>
            {% if subtitle %}
            <p class="text-muted">{{ subtitle }}</p>
            {% endif %}
        </div>
        <div class="col-md-6 text-end">
            <a href="{{ back_url }}" class="btn btn-outline-secondary me-2">
                <i class="fas fa-arrow-left me-1"></i>Voltar
            </a>
            {% if show_edit_button and (is_super_admin or is_admin_central or is_gerente_almox) %}
            <a href="{{ edit_button_url }}" class="btn btn-primary">
                <i class="fas fa-edit me-1"></i>Editar
            </a>
            {% endif %}
        </div>
    </div>

    <!-- Conteúdo dos Detalhes -->
    <div class="row">
        <div class="col-12">
            {% block detail_content %}{% endblock %}
        </div>
    </div>
</div>
{% endmacro %}

<!-- Layout: Dashboard com Widgets -->
{% macro dashboard_layout(title, widgets=[]) %}
<div class="container-fluid">
    <!-- Cabeçalho -->
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="h3 mb-0">{{ title }}</h1>
            <p class="text-muted">{{ scope_name }} - {{ user.nome_completo }}</p>
        </div>
    </div>

    <!-- Widgets Personalizados -->
    <div class="row">
        {% for widget in widgets %}
        {% if widget.access_levels %}
            {% if user.nivel_acesso in widget.access_levels %}
            <div class="col-{{ widget.size|default('lg-6') }} mb-4">
                {% include widget.template %}
            </div>
            {% endif %}
        {% else %}
        <div class="col-{{ widget.size|default('lg-6') }} mb-4">
            {% include widget.template %}
        </div>
        {% endif %}
        {% endfor %}
    </div>
</div>
{% endmacro %}

{# Layout para página de configurações #}
{% macro settings_page_layout(settings_sections) %}
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="h3 mb-0">Configurações do Sistema</h1>
            <p class="text-muted">Gerencie as configurações baseadas no seu nível de acesso</p>
        </div>
    </div>

    <div class="row">
        {% for section in settings_sections %}
        <div class="col-{{ section.size }} mb-4">
            <div class="card h-100">
                <div class="card-header bg-primary text-white">
                    <h5 class="card-title mb-0">
                        <i class="{{ section.icon }} me-2"></i>
                        {{ section.title }}
                    </h5>
                </div>
                <div class="card-body">
                    <p class="card-text">{{ section.content }}</p>
                    
                    {% if section.id == 'hierarquia' %}
                    <div class="hierarchy-structure mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-building text-primary me-2"></i>
                            <strong>Central</strong>
                            <span class="badge bg-primary ms-2">Nível 1</span>
                        </div>
                        <div class="d-flex align-items-center mb-2 ms-3">
                            <i class="fas fa-warehouse text-success me-2"></i>
                            <strong>Almoxarifado</strong>
                            <span class="badge bg-success ms-2">Nível 2</span>
                        </div>
                        <div class="d-flex align-items-center mb-2 ms-4">
                            <i class="fas fa-boxes text-info me-2"></i>
                            <strong>Sub-Almoxarifado</strong>
                            <span class="badge bg-info ms-2">Nível 3</span>
                        </div>
                        <div class="d-flex align-items-center mb-3 ms-5">
                            <i class="fas fa-layer-group text-warning me-2"></i>
                            <strong>Setor</strong>
                            <span class="badge bg-warning ms-2">Nível 4</span>
                        </div>
                    </div>
                    {% elif section.id == 'usuarios' %}
                    <div class="user-levels mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <span class="badge bg-danger me-2">Super Admin</span>
                            <small class="text-muted">Acesso total ao sistema</small>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <span class="badge bg-primary me-2">Admin Central</span>
                            <small class="text-muted">Gerencia centrais específicas</small>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <span class="badge bg-success me-2">Gerente Almox</span>
                            <small class="text-muted">Gerencia almoxarifados</small>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <span class="badge bg-info me-2">Resp. Sub-Almox</span>
                            <small class="text-muted">Responsável por sub-almoxarifados</small>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <span class="badge bg-warning me-2">Operador Setor</span>
                            <small class="text-muted">Opera em setores específicos</small>
                        </div>
                    </div>
                    {% elif section.id == 'categorias' %}
                    <div class="category-examples mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-pills text-primary me-2"></i>
                            <span>Medicamentos</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-tools text-success me-2"></i>
                            <span>Material de Escritório</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-laptop text-info me-2"></i>
                            <span>Equipamentos</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-tshirt text-warning me-2"></i>
                            <span>Uniformes</span>
                        </div>
                    </div>
                    {% elif section.id == 'sistema' %}
                    <div class="system-config mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-server text-primary me-2"></i>
                            <span>Configurações de Servidor</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-shield-alt text-success me-2"></i>
                            <span>Políticas de Segurança</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-clock text-info me-2"></i>
                            <span>Agendamento de Tarefas</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-envelope text-warning me-2"></i>
                            <span>Configurações de Email</span>
                        </div>
                    </div>
                    {% elif section.id == 'auditoria' %}
                    <div class="audit-info mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-history text-primary me-2"></i>
                            <span>Logs de Atividade</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                            <span>Alertas de Segurança</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-user-shield text-success me-2"></i>
                            <span>Auditoria de Usuários</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-file-alt text-info me-2"></i>
                            <span>Relatórios de Compliance</span>
                        </div>
                    </div>
                    {% elif section.id == 'backup' %}
                    <div class="backup-info mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-download text-primary me-2"></i>
                            <span>Backup Automático</span>
                            <span class="badge bg-success ms-auto">Ativo</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-upload text-success me-2"></i>
                            <span>Restauração de Dados</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-archive text-info me-2"></i>
                            <span>Arquivamento</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-cloud text-warning me-2"></i>
                            <span>Backup em Nuvem</span>
                        </div>
                    </div>
                    {% elif section.id == 'integracao' %}
                    <div class="integration-info mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-code text-primary me-2"></i>
                            <span>APIs REST</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-webhook text-success me-2"></i>
                            <span>Webhooks</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-exchange-alt text-info me-2"></i>
                            <span>Sincronização de Dados</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-key text-warning me-2"></i>
                            <span>Chaves de API</span>
                        </div>
                    </div>
                    {% elif section.id == 'relatorios_admin' %}
                    <div class="admin-reports mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-chart-line text-primary me-2"></i>
                            <span>Performance do Sistema</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-users text-success me-2"></i>
                            <span>Estatísticas de Usuários</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-boxes text-info me-2"></i>
                            <span>Movimentação de Estoque</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-calendar text-warning me-2"></i>
                            <span>Relatórios Mensais</span>
                        </div>
                    </div>
                    {% elif section.id == 'perfil' %}
                    <div class="profile-info mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-user text-primary me-2"></i>
                            <span>{{ user.nome if user else 'Nome do Usuário' }}</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-envelope text-success me-2"></i>
                            <span>{{ user.email if user else 'email@exemplo.com' }}</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-shield-alt text-info me-2"></i>
                            <span>{{ user.get_nivel_acesso_display() if user else 'Nível de Acesso' }}</span>
                        </div>
                    </div>
                    {% endif %}
                </div>
                <div class="card-footer">
                    {% if section.action_url and section.action_url != '#' %}
                    <a href="{% if section.action_url.startswith('http') %}{{ section.action_url }}{% else %}{{ url_for(section.action_url) }}{% endif %}" class="btn btn-primary">
                        <i class="fas fa-arrow-right me-2"></i>
                        {{ section.action_text }}
                    </a>
                    {% else %}
                    <a href="#" class="btn btn-secondary disabled" aria-disabled="true">
                        <i class="fas fa-ban me-2"></i>
                        {{ section.action_text }}
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endmacro %}