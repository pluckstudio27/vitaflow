{% extends "base.html" %}

{% block title %}PluckLog - Dashboard{% endblock %}

{% block content %}
<div class="container-fluid">
    <div id="app-root"></div>
    <div id="dashboard-context"
         data-scope-name="{{ scope_name }}"
         data-nivel="{{ user.nivel_acesso }}"
         data-user-nome="{{ user.nome_completo }}"
         data-central="{{ user.central_id or '' }}"
         data-almox="{{ user.almoxarifado_id or '' }}"
         data-sub="{{ user.sub_almoxarifado_id or '' }}"
         data-setor="{{ user.setor_id or '' }}"
         style="display:none"></div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function(){
  var el = document.getElementById('dashboard-context');
  var opts = {
    title: 'Dashboard',
    scopeName: el ? (el.dataset.scopeName || '') : '',
    userContext: {
      nivelAcesso: el ? (el.dataset.nivel || '') : '',
      userNome: el ? (el.dataset.userNome || '') : '',
      centralId: el ? (el.dataset.central || '') : '',
      almoxarifadoId: el ? (el.dataset.almox || '') : '',
      subAlmoxarifadoId: el ? (el.dataset.sub || '') : '',
      setorId: el ? (el.dataset.setor || '') : ''
    }
  };
  if (window.PluckApp && window.PluckApp.mountDashboard){
    window.PluckApp.mountDashboard(opts);
  }
});
</script>
{% endblock %}
